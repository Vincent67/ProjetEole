<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Utilisation d'une procédure stockée avec un nombre de mises à jour</title><meta name="Language" content="fr-fr" /><meta name="Microsoft.Help.Id" content="64cf4877-5995-4bfc-8865-b7618a5c8d01" /><meta name="Description" content="Pour modifier les données d'une base de données SQL Server à l'aide d'une procédure stockée, le Pilote JDBC Microsoft pour SQL Server fournit la classe SQLServerCallableStatement." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Utilisation d'une procédure stockée avec un nombre de mises à jour</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Pour modifier les données d'une base de données SQL Server à l'aide d'une procédure stockée, le Pilote JDBC Microsoft pour SQL Server fournit la classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>. La classe <b>SQLServerCallableStatement</b> permet d'appeler des procédures stockées qui modifient les données contenues dans la base de données et retournent le nombre de lignes affectées, également appelé nombre de mises à jour.</p><p>Une fois l'appel à la procédure stockée configuré à l'aide de la classe <b>SQLServerCallableStatement</b>, vous pouvez appeler la procédure stockée à l'aide de la méthode <a href="e1367f39-23d7-4e26-b160-6d988d7e6988.htm">execute</a> ou de la méthode <a href="10ae662a-ce3c-4b24-875c-5c2df319d93b.htm">executeUpdate</a>. La méthode <b>executeUpdate</b> retourne une valeur <span sdata="langKeyword" value="int"><span class="keyword">int</span></span> contenant le nombre de lignes affectées par la procédure stockée, mais la méthode <b>execute</b> ne le fait pas. Si vous utilisez la méthode <b>execute</b> et souhaitez obtenir le nombre de lignes affectées, vous pouvez appeler la méthode <a href="e9570228-4500-44b6-b2f1-84ac050b5112.htm">getUpdateCount</a> après l'exécution de la procédure stockée.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Si vous souhaitez que le pilote JDBC retourne tous les nombres de mises à jour, y compris les nombres de mises à jour retournées par des déclencheurs qui ont pu se déclencher, définissez la propriété de chaîne de connexion lastUpdateCount sur « false ». Pour plus d'informations sur la propriété lastUpdateCount, consultez <span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Définition des propriétés de connexion</a></span>.</p></div><p>Par exemple, créez la table et la procédure stockée suivantes, et insérez également des exemples de données dans l'exemple de base de données SQL Server 2005 AdventureWorks :</p><div class="sampleCode"><span codeLanguage="other"><pre>CREATE TABLE TestTable 
   (Col1 int IDENTITY, 
    Col2 varchar(50), 
    Col3 int);

CREATE PROCEDURE UpdateTestTable
   @Col2 varchar(50),
   @Col3 int
AS
BEGIN
   UPDATE TestTable
   SET Col2 = @Col2, Col3 = @Col3
END;
INSERT INTO dbo.TestTable (Col2, Col3) VALUES ('b', 10);</pre></span></div><p>Dans l'exemple suivant, une connexion ouverte à l'exemple de base de données AdventureWorks est transmise à la fonction, la méthode <b>execute</b> permet d'appeler la procédure stockée UpdateTestTable, puis la méthode <b>getUpdateCount</b> permet de retourner le nombre de lignes affectées par la procédure stockée. </p><div name="snippetGroup"><div class="sampleCode"><span codeLanguage="Java"><pre>public static void executeUpdateStoredProcedure(Connection con) {
   try {
      CallableStatement cstmt = con.prepareCall("{call dbo.UpdateTestTable(?, ?)}");
      cstmt.setString(1, "A");
      cstmt.setInt(2, 100);
      cstmt.execute();
      int count = cstmt.getUpdateCount();
      cstmt.close();

      System.out.println("ROWS AFFECTED: " + count);
   }
   catch (Exception e) {
      e.printStackTrace();
   }
}

</pre></span></div></div></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">Utilisation d'instructions avec des procédures stockées</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>