<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Méthode getColumns (SQLServerDatabaseMetaData)</title><meta name="Language" content="fr-fr" /><meta name="System.Keywords" content="méthode SQLServerDatabaseMetaData.getColumns" /><meta name="Microsoft.Help.Id" content="f173fa5d-e114-4a37-a5c4-2baad9ff3af1" /><meta name="Description" content="Récupère une description des colonnes d'une table qui sont disponibles dans le catalogue spécifié." /><meta name="Microsoft.Help.ContentType" content="Reference" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Méthode getColumns (SQLServerDatabaseMetaData)</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Récupère une description des colonnes d'une table qui sont disponibles dans le catalogue spécifié.</p></div><h1 class="heading">Syntaxe</h1><div id="syntaxSection" class="section"><div class="sampleCode"><span codeLanguage="other"><pre>
public java.sql.ResultSet <b>getColumns</b>(java.lang.String <span class="parameter" sdata="paramReference">catalog</span>,
                                     java.lang.String <span class="parameter" sdata="paramReference">schema</span>,
                                     java.lang.String <span class="parameter" sdata="paramReference">table</span>,
                                     java.lang.String <span class="parameter" sdata="paramReference">col</span>)</pre></span></div></div><h1 class="heading">Paramètres</h1><div id="parametersSection" class="section" name="collapseableSection" style=""><p><span class="parameter" sdata="paramReference">catalog</span></p><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span> qui contient le nom du catalogue.</p><p><span class="parameter" sdata="paramReference">schema</span></p><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span> qui contient le modèle de nom du schéma.</p><p><span class="parameter" sdata="paramReference">table</span></p><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span> qui contient le modèle de nom de la table.</p><p><span class="parameter" sdata="paramReference">col</span></p><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span> qui contient le modèle de nom de la colonne.</p></div><h1 class="heading">Valeur de retour</h1><div id="returnValueSection" class="section" name="collapseableSection" style=""><p>Objet <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>.</p></div><h1 class="heading">Exceptions</h1><div id="ddueExceptionsSection" class="section" name="collapseableSection" style=""><p><a href="af5ef257-7cf6-4db3-b1ee-07d22d82bef1.htm">SQLServerException</a></p></div><h1 class="heading">Notes</h1><div id="languageReferenceRemarksSection" class="section" name="collapseableSection" style=""><p>Cette méthode <b>getColumns</b> est spécifiée par la méthode <b>getColumns</b> dans l'interface java.sql.DatabaseMetaData.</p><p>Le jeu de résultats retourné par la méthode <b>getColumns</b> contiendra les informations suivantes :</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Nom</p></th><th><p>Type</p></th><th><p>Description</p></th></tr><tr><td><p>TABLE_CAT</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du catalogue.</p></td></tr><tr><td><p>TABLE_SCHEM</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du schéma de la table.</p></td></tr><tr><td><p>TABLE_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom de la table.</p></td></tr><tr><td><p>COLUMN_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom de la colonne.</p></td></tr><tr><td><p>DATA_TYPE</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Type de données SQL de java.sql.Types.</p></td></tr><tr><td><p>TYPE_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du type de données.</p></td></tr><tr><td><p>COLUMN_SIZE</p></td><td><p><span sdata="langKeyword" value="int"><span class="keyword">int</span></span></p></td><td><p>Précision de la colonne.</p></td></tr><tr><td><p>BUFFER_LENGTH</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Taille de transfert des données.</p></td></tr><tr><td><p>DECIMAL_DIGITS</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Échelle de la colonne.</p></td></tr><tr><td><p>NUM_PREC_RADIX</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Base de la colonne.</p></td></tr><tr><td><p>NULLABLE</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Indique si la colonne accepte la valeur Null. Les valeurs possibles sont les suivantes :</p><p>columnNoNulls (0)</p><p>columnNullable (1)</p></td></tr><tr><td><p>REMARKS</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Commentaires associés à la colonne.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>SQL Server retourne toujours la valeur Null pour cette colonne.</p></div></td></tr><tr><td><p>COLUMN_DEF</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Valeur par défaut de la colonne.</p></td></tr><tr><td><p>SQL_DATA_TYPE</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Valeur du type de données SQL telle qu'elle apparaît dans le champ TYPE du descripteur. Cette colonne est la même que la colonne DATA_TYPE, excepté pour le type de données datetime et pour le type de données interval de SQL-92. Cette colonne renvoie toujours une valeur.</p></td></tr><tr><td><p>SQL_DATETIME_SUB</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Code de sous-type pour le type de données datetime et pour le type de données interval de SQL-92. Pour les autres types de données, cette colonne renvoie la valeur NULL.</p></td></tr><tr><td><p>CHAR_OCTET_LENGTH</p></td><td><p><span sdata="langKeyword" value="int"><span class="keyword">int</span></span></p></td><td><p>Nombre maximal d'octets dans la colonne.</p></td></tr><tr><td><p>ORDINAL_POSITION</p></td><td><p><span sdata="langKeyword" value="int"><span class="keyword">int</span></span></p></td><td><p>Index de la colonne dans la table.</p></td></tr><tr><td><p>IS_NULLABLE</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Indique si la colonne autorise les valeurs Null.</p></td></tr><tr><td><p>SS_IS_SPARSE</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Si la colonne est une colonne éparse, la valeur est 1 ; sinon, 0.<sup>1</sup></p></td></tr><tr><td><p>SS_IS_COLUMN_SET</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Si la colonne est la colonne éparse column_set, la valeur est 1 ; sinon, 0. <sup>1</sup></p></td></tr><tr><td><p>SS_IS_COMPUTED</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Indique si une colonne dans un TABLE_TYPE est une colonne calculée. <sup>1</sup></p></td></tr><tr><td><p>IS_AUTOINCREMENT</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>« YES » si la colonne est incrémentée automatiquement. « NO » si la colonne n'est pas incrémentée automatiquement. « » (chaîne vide) si le pilote ne peut pas déterminer si la colonne est incrémentée automatiquement. <sup>1</sup></p></td></tr><tr><td><p>SS_UDT_CATALOG_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du catalogue qui contient le type défini par l'utilisateur (UDT). <sup>1</sup></p></td></tr><tr><td><p>SS_UDT_SCHEMA_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du schéma qui contient le type défini par l'utilisateur (UDT). <sup>1</sup></p></td></tr><tr><td><p>SS_UDT_ASSEMBLY_TYPE_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Type défini par l'utilisateur (UDT) du nom complet. <sup>1</sup></p></td></tr><tr><td><p>SS_XML_SCHEMACOLLECTION_CATALOG_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du catalogue dans lequel un nom de collection de schémas XML est défini. Si le nom du catalogue est introuvable, cette variable contient une chaîne vide. <sup>1</sup></p></td></tr><tr><td><p>SS_XML_SCHEMACOLLECTION_SCHEMA_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du schéma dans lequel un nom de collection de schémas XML est défini. Si le nom du schéma est introuvable, la chaîne est vide. <sup>1</sup></p></td></tr><tr><td><p>SS_XML_SCHEMACOLLECTION_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom d'une collection de schémas XML. Si le nom est introuvable, la chaîne est vide. <sup>1</sup></p></td></tr><tr><td><p>SS_DATA_TYPE</p></td><td><p><span sdata="langKeyword" value="tinyint"><span class="keyword">tinyint</span></span></p></td><td><p>Type de données SQL Server utilisé par les procédures stockées étendues.</p><p><span class="label">Remarque</span>   Pour plus d'informations sur les types de données retournés par SQL Server, consultez « Types de données (Transact-SQL) » dans la documentation en ligne de SQL Server. </p></td></tr></table></div><p> (1) Cette colonne sera absente si vous vous connectez à SQL Server 2005.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Pour plus d'informations sur les données retournées par la méthode <b>getColumns</b>, consultez « sp_columns (Transact-SQL) » dans la documentation en ligne de SQL Server.</p></div><p>Dans le pilote JDBC Microsoft SQL Server version 3.0, vous constaterez les modifications de comportement suivantes par rapport aux précédentes versions du pilote JDBC :</p><p>La colonne DATA_TYPE intègre les modifications suivantes :</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Type de données SQL Server</p></th><th><p>Type de retour dans le pilote JDBC version 2.0 (ou en cas de connexion à SQL Server 2005) et constante numérique associée</p></th><th><p>Type de retour dans le pilote JDBC version 3.0 en cas de connexion à SQL Server 2008 ou version ultérieure</p></th></tr><tr><td><p>type défini par l'utilisateur supérieur à 8 Ko</p></td><td><p>LONGVARBINARY (-4)</p></td><td><p>VARBINARY (-3)</p></td></tr><tr><td><p>geography</p></td><td><p>LONGVARBINARY (-4)</p></td><td><p>VARBINARY (-3)</p></td></tr><tr><td><p>geometry</p></td><td><p>LONGVARBINARY (-4)</p></td><td><p>VARBINARY (-3)</p></td></tr><tr><td><p>varbinary(max)</p></td><td><p>LONGVARBINARY (-4)</p></td><td><p>VARBINARY (-3)</p></td></tr><tr><td><p>nvarchar(max)</p></td><td><p>LONGVARCHAR (-1) ou LONGNVARCHAR (JDBC 4) (-16)</p></td><td><p>VARCHAR (12) ou NVARCHAR (JDBC 4) (-9)</p></td></tr><tr><td><p>varchar(max)</p></td><td><p>LONGVARCHAR (-1)</p></td><td><p>VARCHAR (12)</p></td></tr><tr><td><p>time</p></td><td><p>VARCHAR (12) ou NVARCHAR (JDBC 4) (-9)</p></td><td><p>TIME (-154)</p></td></tr><tr><td><p>date</p></td><td><p>VARCHAR (12) ou NVARCHAR (JDBC 4) (-9)</p></td><td><p>DATE (91)</p></td></tr><tr><td><p>datetime2</p></td><td><p>VARCHAR (12) ou NVARCHAR (JDBC 4) (-9)</p></td><td><p>TIMESTAMP (93)</p></td></tr><tr><td><p>datetimeoffset</p></td><td><p>VARCHAR (12) ou NVARCHAR (JDBC 4) (-9)</p></td><td><p>microsoft.sql.Types.DATETIMEOFFSET  (-155)</p></td></tr></table></div><p>La colonne COLUMN_SIZE intègre les modifications suivantes :</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Type de données SQL Server</p></th><th><p>Type de retour dans le pilote JDBC version 2.0</p></th><th><p>Type de retour dans le pilote JDBC version 3.0</p></th></tr><tr><td><p>nvarchar(max)</p></td><td><p>1073741823</p></td><td><p>2147483647 (métadonnées de base de données)</p></td></tr><tr><td><p>xml</p></td><td><p>1073741823</p></td><td><p>2147483647 (métadonnées de base de données)</p></td></tr><tr><td><p>type défini par l'utilisateur inférieur ou égal à 8 Ko</p></td><td><p>8 Ko (jeu de résultats et métadonnées de paramètre)</p></td><td><p>Taille réelle retournée par la procédure stockée.</p></td></tr><tr><td><p>time</p></td><td><p /></td><td><p>Longueur en caractères de la représentation de chaîne du type, en tenant compte de la précision maximale autorisée pour le composant fractions de seconde.</p></td></tr><tr><td><p>date</p></td><td><p /></td><td><p>identique à time</p></td></tr><tr><td><p>datetime2</p></td><td><p /></td><td><p>identique à time</p></td></tr><tr><td><p>datetimeoffset</p></td><td><p /></td><td><p>identique à time</p></td></tr></table></div><p>La colonne BUFFER_LENGTH intègre la modification suivante :</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Type de données SQL Server</p></th><th><p>Type de retour dans le pilote JDBC version 2.0</p></th><th><p>Type de retour dans le pilote JDBC version 3.0</p></th></tr><tr><td><p>type défini par l'utilisateur supérieur à 8 Ko</p></td><td /><td><p>2147483647</p></td></tr></table></div><p>La colonne TYPE_NAME intègre les modifications suivantes :</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Type de données SQL Server</p></th><th><p>Type de retour dans le pilote JDBC version 2.0</p></th><th><p>Type de retour dans le pilote JDBC version 3.0</p></th></tr><tr><td><p>varchar(max)</p></td><td><p>text</p></td><td><p>varchar</p></td></tr><tr><td><p>varbinary(max)</p></td><td><p>image</p></td><td><p>varbinary</p></td></tr></table></div><p>La colonne DECIMAL_DIGITS intègre les modifications suivantes :</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Type SQL Server</p></th><th><p>Pilote JDBC version 2.0</p></th><th><p>Pilote JDBC version 3.0</p></th></tr><tr><td><p>time</p></td><td><p>null</p></td><td><p>7 (ou inférieur, si spécifié)</p></td></tr><tr><td><p>date</p></td><td><p>null</p></td><td><p>null</p></td></tr><tr><td><p>datetime2</p></td><td><p>null</p></td><td><p>7 (ou inférieur, si spécifié)</p></td></tr><tr><td><p>datetimeoffset</p></td><td><p>null</p></td><td><p>7 (ou inférieur, si spécifié)</p></td></tr></table></div><p>La colonne SQL_DATA_TYPE intègre les modifications suivantes :</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Type de données SQL Server</p></th><th><p>Valeur des données SQL Server 2008 dans le pilote JDBC version 2.0</p></th><th><p>Valeur des données SQL Server 2008 dans le pilote JDBC version 3.0</p></th></tr><tr><td><p>varchar(max)</p></td><td><p>-10</p></td><td><p>-9</p></td></tr><tr><td><p>nvarchar(max)</p></td><td><p>-1</p></td><td><p>-9</p></td></tr><tr><td><p>xml</p></td><td><p>-10</p></td><td><p>-152</p></td></tr><tr><td><p>type défini par l'utilisateur inférieur ou égal à 8 Ko</p></td><td><p>-3</p></td><td><p>-151</p></td></tr><tr><td><p>type défini par l'utilisateur supérieur à 8 Ko</p></td><td><p>Non disponible dans le pilote JDBC version 2.0</p></td><td><p>-151</p></td></tr><tr><td><p>geography</p></td><td><p>-4</p></td><td><p>-151</p></td></tr><tr><td><p>geometry</p></td><td><p>-4</p></td><td><p>-151</p></td></tr><tr><td><p>hierarchyid</p></td><td><p>-4</p></td><td><p>-151</p></td></tr><tr><td><p>time</p></td><td><p>-9</p></td><td><p>92</p></td></tr><tr><td><p>date</p></td><td><p>-9</p></td><td><p>91</p></td></tr><tr><td><p>datetime2</p></td><td><p>-9</p></td><td><p>93</p></td></tr><tr><td><p>datetimeoffset</p></td><td><p>-9</p></td><td><p>-155</p></td></tr></table></div></div><h1 class="heading">Exemple</h1><div id="exampleSection" class="section" name="collapseableSection" style=""><p>L'exemple suivant montre comment utiliser la méthode <b>getColumns</b> pour retourner des informations pour la table Person.Contact dans l'exemple de base de données SQL Server 2005 AdventureWorks.</p><div class="sampleCode"><span codeLanguage="other"><pre>import java.sql.*;
public class c1 {
   public static void main(String[] args) {
      String connectionUrl = "jdbc:sqlserver://localhost:1433;databaseName=AdventureWorks;integratedsecurity=true";

      Connection con = null;
      Statement stmt = null;
      ResultSet rs = null;

      try {
         Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
         con = DriverManager.getConnection(connectionUrl);
         DatabaseMetaData dbmd = con.getMetaData();
         rs = dbmd.getColumns("AdventureWorks", "Person", "Contact", "FirstName");
         
         ResultSet r = dbmd.getColumns(null, null, "Contact", null);
         ResultSetMetaData rm = r.getMetaData(); 
         int noofcols = rm.getColumnCount();
         
         if (r.next())
            for (int i = 0 ; i &lt; noofcols ; i++ )
            System.out.println(rm.getColumnName( i + 1 ) + ": \t\t" + r.getString( i + 1 ));
      }

      catch (Exception e) {}
      finally {}
   }
}</pre></span></div></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="8b8049d0-8c6d-4476-866b-098709f37eec.htm">Classe SQLServerDatabaseMetaData</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="772de447-c922-4b85-8e10-5f0d9277966c.htm">Méthodes SQLServerDatabaseMetaData</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="327ba0bc-438a-494c-b119-1cd4a096bb58.htm">Membres de SQLServerDatabaseMetaData</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>