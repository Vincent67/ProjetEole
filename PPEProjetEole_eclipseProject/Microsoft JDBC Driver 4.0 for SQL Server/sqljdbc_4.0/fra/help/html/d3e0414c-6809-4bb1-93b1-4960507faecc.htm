<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Transactions</title><meta name="Language" content="fr-fr" /><meta name="System.Keywords" content="transactions" /><meta name="Microsoft.Help.Id" content="d3e0414c-6809-4bb1-93b1-4960507faecc" /><meta name="Description" content="Les transactions sont des groupes d'opérations combinés en unités logiques de travail." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Transactions</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Les transactions sont des groupes d'opérations combinés en unités logiques de travail. Elles sont utilisées pour contrôler et maintenir la cohérence et l'intégrité de chaque action dans une transaction, malgré les erreurs pouvant se produire dans le système. </p><p>Avec le Pilote JDBC Microsoft pour SQL Server, les transactions peuvent être locales ou distribuées. Les transactions peuvent également utiliser des niveaux d'isolation. Pour plus d'informations sur les niveaux d'isolation pris en charge par le pilote JDBC, consultez <span sdata="link"><a href="2c41e23a-da6c-4650-b5fc-b5fe53ba65c3.htm">Fonctionnement des niveaux d'isolement</a></span>.</p><p>Les applications doivent contrôler les transactions en utilisant des instructions Transact-SQL ou les méthodes fournies par le pilote JDBC, mais pas les deux. L'utilisation des instructions Transact-SQL et des méthodes de l'API JDBC sur la même transaction peut entraîner des problèmes, par exemple une transaction qui ne peut pas être validée comme prévu, une transaction qui est validée ou restaurée, et une nouvelle qui démarre de façon inattendue, ou des exceptions de type « Le serveur n'a pas pu reprendre la transaction ».</p></div><h1 class="heading">Utilisation de transactions locales</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Une transaction est considérée comme locale lorsqu'il s'agit d'une transaction à phase unique traitée directement par la base de données. Le pilote JDBC prend en charge les transactions locales à l'aide de diverses méthodes de la classe <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>, y compris <a href="db1e22d2-e53f-474e-8c99-cb1fff7f491a.htm">setAutoCommit</a>, <a href="c7346165-51bf-4844-b64c-29833c147236.htm">commit</a> et <a href="7adb6772-4047-4d8e-931d-b3d20eec44b5.htm">rollback</a>. Les transactions locales sont généralement gérées explicitement par l'application ou automatiquement par le serveur d'applications Java EE (Java Platform, Enterprise Edition).</p><p>L'exemple suivant effectue une transaction locale comprenant deux instructions distinctes dans le bloc<span class="code"> try </span>. Les instructions sont exécutées sur la table Production.ScrapReason dans l'exemple de base de données AdventureWorks SQL Server 2005 et sont validées si aucune exception n'est générée. Le code dans le bloc <span class="code"> catch </span> annule la transaction en cas d'exception.</p><div name="snippetGroup"><div class="sampleCode"><span codeLanguage="Java"><pre>public static void executeTransaction(Connection con) {
   try {
      //Switch to manual transaction mode by setting
      //autocommit to false. Note that this starts the first 
      //manual transaction.
      con.setAutoCommit(false);
      Statement stmt = con.createStatement();
      stmt.executeUpdate("INSERT INTO Production.ScrapReason(Name) VALUES('Wrong size')");
      stmt.executeUpdate("INSERT INTO Production.ScrapReason(Name) VALUES('Wrong color')");
      con.commit(); //This commits the transaction and starts a new one.
      stmt.close(); //This turns off the transaction.
      System.out.println("Transaction succeeded. Both records were written to the database.");
   }
   catch (SQLException ex) {
      ex.printStackTrace();
      try {
         System.out.println("Transaction failed.");
         con.rollback();
      }
      catch (SQLException se) {
         se.printStackTrace();
      }
   }
}

</pre></span></div></div></div><h1 class="heading">Utilisation de transactions distribuées</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Une transaction distribuée met à jour les données sur au moins deux bases de données en réseau, tout en conservant les propriétés ACID (Atomicité, Cohérence, Isolation et Durabilité) importantes du traitement de transactions. La prise en charge de transactions distribuées a été ajoutée à l'API de JDBC dans la spécification de l'API facultative de JDBC 2.0. Les transactions distribuées sont généralement gérées automatiquement par le gestionnaire de transactions JTS (Java Transaction Service) dans l'environnement d'un serveur d'applications Java EE. Cependant, le Pilote JDBC Microsoft pour SQL Server prend en charge les transactions distribuées dans tout gestionnaire de transactions compatible avec l'API de transaction Java (JTA).</p><p>Le pilote JDBC est intégré de manière transparente à MS DTC (Microsoft Distributed Transaction Coordinator) pour offrir une véritable prise en charge des transactions distribuées avec SQL Server. MS DTC est une fonctionnalité de transactions distribuées fournie par Microsoft pour les systèmes d'exploitation Microsoft Windows. MS DTC utilise l'excellente technologie Microsoft de traitement des transactions pour prendre en charge les caractéristiques XA, telles que le protocole de validation distribué complet à deux phases et la récupération des transactions distribuées.</p><p>Pour plus d'informations sur l'utilisation des transactions distribuées, consultez <span sdata="link"><a href="574e326f-0520-4003-bdf1-62d92c3db457.htm">Transactions XA</a></span>.</p></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="afbb776f-05dc-4e79-bb25-2c340483e401.htm">Exécution de transactions avec le pilote JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>