<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Wrappers et interfaces</title><meta name="Language" content="fr-fr" /><meta name="Microsoft.Help.Id" content="27fc9b72-9f21-4728-abcb-5c015f28a6ab" /><meta name="Description" content="Le Pilote JDBC Microsoft pour SQL Server prend en charge les interfaces qui vous permettent de créer un proxy d'une classe, ainsi que les wrappers qui vous permettent d'accéder à des extensions de l'API JDBC spécifiques au Pilote JDBC Microsoft pour SQL Se" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Wrappers et interfaces</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Le Pilote JDBC Microsoft pour SQL Server prend en charge les interfaces qui vous permettent de créer un proxy d'une classe, ainsi que les wrappers qui vous permettent d'accéder à des extensions de l'API JDBC spécifiques au Pilote JDBC Microsoft pour SQL Server via une interface proxy.</p></div><h1 class="heading">Wrappers</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Le Pilote JDBC Microsoft pour SQL Server prend en charge l'interface java.sql.Wrapper. Cette interface fournit un mécanisme d'accès aux extensions de l'API JDBC qui sont spécifiques au Pilote JDBC Microsoft pour SQL Server via une interface proxy.</p><p>L'interface java.sql.Wrapper définit deux méthodes : <span sdata="langKeyword" value="isWrapperFor"><span class="keyword">isWrapperFor</span></span> et <span sdata="langKeyword" value="unwrap"><span class="keyword">unwrap</span></span>. La méthode <span sdata="langKeyword" value="isWrapperFor"><span class="keyword">isWrapperFor</span></span> vérifie si l'objet d'entrée spécifié implémente cette interface. La méthode <span sdata="langKeyword" value="unwrap"><span class="keyword">unwrap</span></span> retourne un objet qui implémente cette interface afin d'autoriser l'accès aux méthodes spécifiques au Pilote JDBC Microsoft pour SQL Server.</p><p>Les méthodes <span sdata="langKeyword" value="isWrapperFor"><span class="keyword">isWrapperFor</span></span> et <span sdata="langKeyword" value="unwrap"><span class="keyword">unwrap</span></span> sont exposées comme suit :</p><ul><li><p><span sdata="link"><a href="71156863-3588-453e-b5a5-0573b2c1bebf.htm">Méthode isWrapperFor (SQLServerCallableStatement)</a></span></p></li><li><p><span sdata="link"><a href="cbbf2728-b8c8-4c35-875a-6e967c8285dc.htm">Méthode unwrap (SQLServerCallableStatement)</a></span></p></li><li><p><span sdata="link"><a href="09ed10eb-6e46-437b-a7c0-3c55574aad38.htm">Méthode isWrapperFor (SQLServerConnectionPoolDataSource)</a></span></p></li><li><p><span sdata="link"><a href="f5c9b734-2096-4ae4-a284-6b4d1b4a00d4.htm">Méthode unwrap (SQLServerConnectionPoolDataSource)</a></span></p></li><li><p><span sdata="link"><a href="f77af027-c021-4a17-b264-1ee592bfdd84.htm">Méthode isWrapperFor (SQLServerDataSource)</a></span></p></li><li><p><span sdata="link"><a href="eb8abe29-f3ec-4752-a590-1d5dc3e48f08.htm">Méthode unwrap (SQLServerDataSource)</a></span></p></li><li><p><span sdata="link"><a href="b0e591b1-73e2-4f90-967f-5555eadfc3f1.htm">Méthode isWrapperFor (SQLServerPreparedStatement)</a></span></p></li><li><p><span sdata="link"><a href="8e3ec950-3ac1-4c28-9e97-ddce3bd46578.htm">Méthode unwrap (SQLServerPreparedStatement)</a></span></p></li><li><p><span sdata="link"><a href="53f3291f-d43a-476b-a656-d86168dacf6c.htm">Méthode isWrapperFor (SQLServerStatement)</a></span></p></li><li><p><span sdata="link"><a href="ce680176-ef04-4e44-bb6c-ec50bd06e7e6.htm">Méthode unwrap (SQLServerStatement)</a></span></p></li><li><p><span sdata="link"><a href="d612461d-4c3f-46db-b968-ff4c80b2aa7c.htm">Méthode isWrapperFor (SQLServerXADataSource)</a></span></p></li><li><p><span sdata="link"><a href="d97c99b3-2224-4abb-8b32-40aff49fe759.htm">Méthode unwrap (SQLServerXADataSource)</a></span></p></li></ul></div><h1 class="heading">Interfaces</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>À compter de la version 3.0 du pilote JDBC SQL Server, des interfaces sont disponibles pour qu'un serveur d'applications accède à une méthode spécifique du pilote à partir de la classe associée. Le serveur d'applications peut encapsuler la classe en créant un proxy, exposant la fonctionnalité spécifique du Pilote JDBC Microsoft pour SQL Server à partir d'une interface. Le Pilote JDBC Microsoft pour SQL Server prend en charge les interfaces disposant de méthodes et constantes spécifiques au Pilote JDBC Microsoft pour SQL Server, de sorte qu'un serveur d'applications puisse créer un proxy de la classe.</p><p>Les interfaces sont dérivées d'interfaces Java standard. Par conséquent, vous pouvez utiliser le même objet une fois qu'il est désencapsulé pour accéder à la fonctionnalité spécifique ou générique du Pilote JDBC Microsoft pour SQL Server.</p><p>Les interfaces suivantes ont été ajoutées :</p><ul><li><p><a href="030a1631-cfcd-41e0-beb5-47f93c01e8e0.htm">ISQLServerCallableStatement</a></p></li><li><p><a href="031c01e2-2c65-4fe4-9700-fdbcc7a39f30.htm">ISQLServerConnection</a></p></li><li><p><a href="ba1d3242-19ca-4321-83fe-867a4f69f1d4.htm">ISQLServerDataSource</a></p></li><li><p><a href="cf87892e-5c34-4ac6-8258-c2a81e117b26.htm">ISQLServerPreparedStatement</a></p></li><li><p><a href="002496f7-8ec0-4267-b4e6-ba095e2ef306.htm">ISQLServerResultSet</a></p></li><li><p><a href="7f83b514-6e76-4f37-baf3-a10db2010e7c.htm">ISQLServerStatement</a></p></li></ul></div><h1 class="heading">Exemple</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><h1 class="heading">Description</h1><div class="subsection"><p>L'exemple suivant montre comment accéder à une fonctionnalité spécifique du Pilote JDBC Microsoft pour SQL Server à partir d'un objet <b>DataSource</b>. Cette classe <b>DataSource</b> peut avoir été encapsulée par un serveur d'applications. Pour accéder à la fonctionnalité ou constante spécifique du pilote JDBC, vous pouvez désencapsuler la source de données dans une interface <b>ISQLServerDataSource</b> et utiliser les fonctionnalités déclarées dans cette interface.</p></div><h1 class="heading">Code</h1><div class="subsection"><div class="sampleCode"><span codeLanguage="other"><pre>import javax.sql.*;
import java.sql.*;
import com.microsoft.sqlserver.jdbc.*;

public class UnWrapTest {
   public static void main(String[] args) {
      // This is a test.  This DataSource object could be something from an appserver 
      // which has wrapped the real SQLServerDataSource with its own wrapper
      SQLServerDataSource ds = new SQLServerDataSource();
      checkSendStringParametersAsUnicode(ds);
   }

   // Unwrap to the ISQLServerDataSource interface to access the getSendStringParametersAsUnicode function
   static void checkSendStringParametersAsUnicode(DataSource ds) {
      try {
         final ISQLServerDataSource sqlServerDataSource = ds.unwrap(ISQLServerDataSource.class);
         boolean sendStringParametersAsUnicode = sqlServerDataSource.getSendStringParametersAsUnicode();

         System.out.println("Send string as parameter value is:-" + sendStringParametersAsUnicode);

      } catch (SQLException sqlE) {
         System.out.println("Exception:-" + sqlE);
      }
   }
}</pre></span></div></div></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7802328d-4d23-4775-9573-4169b127d258.htm">Présentation des types de données de pilote JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>